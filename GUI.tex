\section{Displej}
Aby byl budík uživatelsky přívětivý, je nutné umožnit jeho nastavování bez
nutnosti připojení jiného zařízení (počítače, mobilního telefonu apod.).
Pro zobrazování dat se v dnešní době využívá široká škála různých technologií
displejů. Vzhledem k textovému charakteru zobrazovaných dat jsou pro toto
zařízení vhodné znakové či grafické displeje, segmentové displeje by neumožnily
zobrazení většího množství údajů na jednom místě. Protože není potřeba
zobrazovat složitou grafiku, zvolil jsem znakový LCD displej (16 znaků na
řádek, 2 řádky) s řadičem HD44780. Ten je asi nejlevnější alternativou, je
snadno dostupný a díky možnosti nadefinovat několik vlastních znaků lze
zobrazovat i jednoduchou grafiku.

Řadič HD44780 využívá pro komunikaci 8bitovou sběrnici ($\mathrm{DB0}$ až
$\mathrm{DB7}$) a tři řídicí piny: $\mathrm{R}/\overline{\mathrm{W}}$,
$\mathrm{E}$ a $\mathrm{RS}$. Pin $\mathrm{R}/\overline{\mathrm{W}}$ určuje,
jestli požaduje mikrokontrolér čtení dat z řadiče (logická 1) či zápis (logická
0). V obou případech se data přenášejí po sběrnici. Pin $\mathrm{E}$ zahajuje
operaci čtení či zápisu. $\mathrm{RS}$ určuje, jestli jsou data na sběrnici
daty pro zápis do paměti řadiče ($\mathrm{RS} = 1$, obvykle zápis ASCII hodnoty
požadovaného znaku) nebo instrukce, kterou má řadič provést ($\mathrm{RS} =
0$). Podporované instrukce zahrnují smazání displeje, zapnutí blikání kurzoru
apod. Řadič umožňuje i provoz ve 4bitovém režimu, v takovém případě se ze
sběrnice využijí pouze piny $\mathrm{DB4}$ až $\mathrm{DB7}$.~\cite{dshHD44780}

Pro nedostatek I/O portů použitého MCU je displej připojen přes
8bitový I\textsuperscript{2}C I/O expandér PCF8574. Komunikace s řadičem
HD44780 probíhá vzhledem k malému počtu dostupných pinů ve 4bitovém režimu.
Expandér PCF8574 má 8 pinů, které lze nezávisle nastavit jako vstup či výstup.
Výstupní pin $\overline{\mathrm{INT}}$ může být využit pro spuštění
hardwarového přerušení (interrupt) na straně MCU při změně stavu vstupních
pinů, MCU tedy nemusí pravidelně kontrolovat jejich stav.~\cite{dshPCF8574}

\todo[inline]{blokove schema, knihovna, ...}


Expandér ovládá také podsvícení displeje. To je zajištěno elektroluminiscenční
diodou (LED) svítící z boku do plexiskla pod open cell. V běžně prodávaných
znakových LCD je osazovány bílé LED, přičemž vlastní open cell je modrý. Pro
použití v podmínkách s nízkou intenzitou osvětlení ale považuji za vhodnější
podsvícení červenou barvou. \todo{ozdrojovat modre svetlo v noci}
Když pro podsvícení použijeme červenou LED, blokuje
open cell \todo{open cell - cesky termin nebo obrazek}
většinu světla a ven z panelu vychází červené světlo pouze v místech, kde jsou
otevřené pixely.

\todo[inline]{modifikace LCD - dopsat}
Modifikace barvy podsvícení není triviální, protože se na trhu vyskytuje mnoho
displejů se stejnými rozměry, komunikačním rozhraním apod., ale s rozdílným
provedením podsvětlení (BLU). U všech autorem zakoupených displejů je
podsvícení řešenou jednou LED zapuštěnou do plexiskla na pravé straně displeje.
LED je na desce plošných spojů připájena do prokovených děr, které jsou na
hraně PCB a přesně v polovině odfrézovány. Důvod pro toto řešení je
pravděpodobně zjednodušení montáže při výrobě. Jednotlivé displeje se ale liší
tvarem plexiskla a montáží LED do tohoto plexiskla.
% obrazek dve varianty zasazeni LED do plexiskla
